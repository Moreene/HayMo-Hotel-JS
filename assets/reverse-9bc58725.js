import"./bootstrap-3dca8c45.js";import"./centerHeader-436f0069.js";import"./hamMenu-6b7faa69.js";import l from"https://cdnjs.cloudflare.com/ajax/libs/axios/1.5.1/esm/axios.js";import{e as r,i as p,j as d,s as h}from"./config-e6f0afb8.js";$(function(){$.datepicker.regional["zh-TW"]={dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayNamesMin:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],prevText:"上月",nextText:"次月",weekHeader:"週"},$.datepicker.setDefaults($.datepicker.regional["zh-TW"]),$(function(){$(".datepicker").datepicker({beforeShow:function(t,a){a.dpDiv.addClass("custom-datepicker")},dateFormat:"yy-mm-dd",minDate:1,maxDate:"+3M",onSelect:function(t,a){e.date=t,console.log(e)}}),$(".datepicker").on("change",function(t){const a=t.target.value;a&&(e.date=a,console.log(e))}),$(".startDate").datepicker({beforeShow:function(t,a){a.dpDiv.addClass("custom-datepicker")},dateFormat:"yy-mm-dd",minDate:1,maxDate:"+3M",onSelect:function(t,a){const n=new Date(t);if(e.endDate){const o=new Date(e.endDate);n>o?(r("入住日期不能大於退房日期！","請重新選擇日期"),$(".startDate").val("")):n.getDate()===o.getDate()&&n.getMonth()===o.getMonth()&&n.getFullYear()===o.getFullYear()?(r("入住日期不能與退房日期相同！","請重新選擇日期"),$(".startDate").val("")):e.startDate=t}else e.startDate=t;console.log(e)}}),$(".endDate").datepicker({beforeShow:function(t,a){a.dpDiv.addClass("custom-datepicker")},dateFormat:"yy-mm-dd",minDate:1,maxDate:"+3M",onSelect:function(t,a){const n=new Date(t);if(e.startDate){const o=new Date(e.startDate);o>n?(r("退房日期不能小於入住日期！","請重新選擇日期"),$(".endDate").val("")):o.getDate()===n.getDate()&&o.getMonth()===n.getMonth()&&o.getFullYear()===n.getFullYear()?(r("入住日期不能與退房日期相同！","請重新選擇日期"),$(".endDate").val("")):e.endDate=t}else e.endDate=t;console.log(e)}})})});$(".startDate").on("change",function(t){const a=t.target.value;if(a){const n=new Date(a);if(e.endDate){const o=new Date(e.endDate);n>o?(r("入住日期不能大於退房日期！","請重新選擇日期"),$(".startDate").val("")):n.getDate()===o.getDate()&&n.getMonth()===o.getMonth()&&n.getFullYear()===o.getFullYear()?(r("入住日期不能與退房日期相同！","請重新選擇日期"),$(".startDate").val("")):e.startDate=a}else e.startDate=a;console.log(e)}});$(".endDate").on("change",function(t){const a=t.target.value;if(a){const n=new Date(a);if(e.startDate){const o=new Date(e.startDate);o>n?(r("退房日期不能小於入住日期！","請重新選擇日期"),$(".endDate").val("")):o.getDate()===n.getDate()&&o.getMonth()===n.getMonth()&&o.getFullYear()===n.getFullYear()?(r("入住日期不能與退房日期相同！","請重新選擇日期"),$(".endDate").val("")):e.endDate=a}else e.endDate=a;console.log(e)}});$(document).ready(function(){$(".timepicker").timepicker({timeFormat:"h:i A",step:60,minTime:"9:00",maxTime:"21:00",startTime:"9:00",dynamic:!0}),$(".timepicker").on("changeTime",function(){e.time=$(this).val(),console.log(e)})});(function(){var t=document.querySelectorAll(".needs-validation");Array.prototype.slice.call(t).forEach(function(a){a.addEventListener("submit",function(n){a.checkValidity()||(n.preventDefault(),n.stopPropagation()),a.classList.add("was-validated")},!1)})})();const i=location.href.split("=")[1],e={service:"狗狗安親"},v=document.querySelector(".js-service");v.addEventListener("click",function(t){t.target.textContent==="狗狗安親"?e.service="狗狗安親":t.target.textContent==="狗狗美容"?e.service="狗狗美容":t.target.textContent==="狗狗住宿"&&(e.service="狗狗住宿"),console.log(e)});function D(){l.get(`${d}/660/dogs?userId=${i}`,{headers:{authorization:`Bearer ${localStorage.getItem("userToken")}`}}).then(t=>{if(t){let a=t.data;k(a)}}).catch(t=>{console.log(t)})}D();const g=document.querySelectorAll(".js-nameSelect");function k(t){let a="";t.forEach(n=>{a+=`<option value="${n.name}">${n.name}</option>`}),g.forEach(n=>{n.insertAdjacentHTML("beforeend",a)})}g.forEach(function(t){t.addEventListener("change",function(a){e.dogName=a.target.value,console.log(e)})});const S=document.querySelectorAll(".js-paradise");S.forEach(t=>{t.addEventListener("click",function(a){a.target.classList.contains("form-check-input")&&(e.paradise=a.target.value,console.log(e))})});const y=document.querySelectorAll("#emergencyContact"),E=document.querySelectorAll("#emergencyPhone");function L(){l.get(`${d}/660/users/${i}`,{headers:{authorization:`Bearer ${localStorage.getItem("userToken")}`}}).then(t=>{if(t){let a=t.data;N(a),F(a)}}).catch(t=>{console.log(t)})}L();function N(t){let a="";a=`<option value="${t.name}"></option>`,y.forEach(n=>{n.insertAdjacentHTML("beforeend",a)})}function F(t){let a="";a=`<option value="${t.phone}"></option>`,E.forEach(n=>{n.insertAdjacentHTML("beforeend",a)})}const q=document.querySelectorAll(".js-contact"),M=document.querySelectorAll(".js-phone"),w=document.querySelectorAll("#remark");q.forEach(t=>{t.addEventListener("input",function(a){a.target.value!==""&&(e.contact=a.target.value.trim(),console.log(e))})});M.forEach(t=>{t.addEventListener("change",function(a){e.phone=a.target.value.trim(),console.log(e)})});w.forEach(t=>{t.addEventListener("input",function(a){e.remark=a.target.value.trim(),console.log(e)}),t.dispatchEvent(new Event("input"))});const j=document.querySelector(".js-size");j.addEventListener("click",function(t){t.target.value!==void 0&&(t.target.value==="小於10kg"?e.dogSize="小於10kg":t.target.value==="10-20kg"?e.dogSize="10-20kg":t.target.value==="大於20kg"&&(e.dogSize="大於20kg"),console.log(e))});const A=document.querySelector(".js-plan");A.addEventListener("click",function(t){t.target.value!==void 0&&(t.target.value==="基礎洗香香"?e.plan="基礎洗香香":t.target.value==="進階洗香香"?e.plan="進階洗香香":t.target.value==="高級洗香香"&&(e.plan="高級洗香香"),console.log(e))});const C=document.querySelector(".js-room");C.addEventListener("click",function(t){t.target.value!==void 0&&(t.target.value==="小狗香香房"?e.room="小狗香香房":t.target.value==="忠犬呼嚕房"?e.room="忠犬呼嚕房":t.target.value==="大狗好眠房"&&(e.room="大狗好眠房"),console.log(e))});const f=document.querySelectorAll("form");let u=!1;u||(f.forEach(t=>{t.addEventListener("submit",b)}),u=!0);function b(t){t.preventDefault(),f.forEach(a=>{if(a.checkValidity())if(!p(e.phone))a.querySelector(".js-phoneError").innerHTML='<i class="bi bi-exclamation-circle me-4"></i>手機號碼格式錯誤',a.querySelector(".js-phone").value="";else{let n={};if(e.service==="狗狗安親"){const o=s();n={userId:i,dogName:e.dogName,service:e.service,date:e.date,time:e.time,paradise:e.paradise,contact:e.contact,phone:e.phone,remark:e.remark,orderNum:o}}else if(e.service==="狗狗美容"){const o=s();n={userId:i,dogName:e.dogName,service:e.service,size:e.dogSize,plan:e.plan,date:e.date,time:e.time,paradise:e.paradise,contact:e.contact,phone:e.phone,remark:e.remark,orderNum:o}}else if(e.service==="狗狗住宿"){const o=s();n={userId:i,dogName:e.dogName,service:e.service,room:e.room,startDate:e.startDate,endDate:e.endDate,time:e.time,contact:e.contact,phone:e.phone,remark:e.remark,orderNum:o}}l.post(`${d}/660/reverse`,n,{headers:{authorization:`Bearer ${localStorage.getItem("userToken")}`}}).then(o=>{h("預約成功！","",3e3),a.reset(),a.classList.remove("was-validated")}).catch(o=>{console.log(o)})}else{t.stopPropagation();return}})}const m=[];function s(){let t;do t=`Z0${String(Math.floor(Math.random()*1e5)).padStart(5,"0")}`;while(m.includes(t));return m.push(t),t}function c(t){document.querySelector(`.${t}`).reset(),document.querySelector(`.${t}`).classList.remove("was-validated")}document.querySelectorAll(".option-link").forEach(t=>{t.addEventListener("click",a=>{a.target.textContent==="狗狗安親"?(c("cosmeticForm"),c("stayForm")):a.target.textContent==="狗狗美容"?(c("dayCareForm"),c("stayForm")):a.target.textContent==="狗狗住宿"&&(c("dayCareForm"),c("cosmeticForm"))})});

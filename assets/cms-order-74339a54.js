import"./bootstrap-3dca8c45.js";import v from"https://cdnjs.cloudflare.com/ajax/libs/axios/1.5.1/esm/axios.js";import{e as l,j as k,a as S,i as w,s as T}from"./config-e6f0afb8.js";$(function(){$.datepicker.regional["zh-TW"]={dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayNamesMin:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],prevText:"上月",nextText:"次月",weekHeader:"週"},$.datepicker.setDefaults($.datepicker.regional["zh-TW"]),$(function(){$(".datepicker").datepicker({beforeShow:function(t,e){e.dpDiv.addClass("custom-datepicker")},dateFormat:"yy-mm-dd",minDate:1,maxDate:"+3M",onSelect:function(t,e){}}),$(".startDate").datepicker({beforeShow:function(t,e){e.dpDiv.addClass("custom-datepicker")},dateFormat:"yy-mm-dd",minDate:1,maxDate:"+3M",onSelect:function(t,e){const a=new Date(t),n=new Date($(".endDate").val());n&&(a>n?(l("入住日期不能大於退房日期！","請重新選擇日期"),$(".startDate").val("")):a.getDate()===n.getDate()&&a.getMonth()===n.getMonth()&&a.getFullYear()===n.getFullYear()&&(l("入住日期不能與退房日期相同！","請重新選擇日期"),$(".startDate").val("")))}}),$(".endDate").datepicker({beforeShow:function(t,e){e.dpDiv.addClass("custom-datepicker")},dateFormat:"yy-mm-dd",minDate:1,maxDate:"+3M",onSelect:function(t,e){const a=new Date(t),n=new Date($(".startDate").val());n&&(n>a?(l("退房日期不能小於入住日期！","請重新選擇日期"),$(".endDate").val("")):n.getDate()===a.getDate()&&n.getMonth()===a.getMonth()&&n.getFullYear()===a.getFullYear()&&(l("入住日期不能與退房日期相同！","請重新選擇日期"),$(".endDate").val("")))}})})});$(".startDate").on("change",function(t){const e=t.target.value;if(e){const a=new Date(e),n=new Date($(".endDate").val());n&&a>n?(l("入住日期不能大於退房日期！","請重新選擇日期"),$(".startDate").val("")):n&&a.getTime()===n.getTime()&&(l("入住日期不能與退房日期相同！","請重新選擇日期"),$(".startDate").val(""))}});$(".endDate").on("change",function(t){const e=t.target.value;if(e){const a=new Date(e),n=new Date($(".startDate").val());n&&n>a?(l("退房日期不能小於入住日期！","請重新選擇日期"),$(".endDate").val("")):n&&n.getTime()===a.getTime()&&(l("入住日期不能與退房日期相同！","請重新選擇日期"),$(".endDate").val(""))}});$(document).ready(function(){$(".timepicker").timepicker({timeFormat:"h:i A",step:60,minTime:"9:00",maxTime:"21:00",startTime:"9:00",dynamic:!0}),$(".timepicker").on("changeTime",function(){$(this).val()})});(function(){var t=document.querySelectorAll(".needs-validation");Array.prototype.slice.call(t).forEach(function(e){e.addEventListener("submit",function(a){e.checkValidity()||(a.preventDefault(),a.stopPropagation()),e.classList.add("was-validated")},!1)})})();document.querySelectorAll(".nav-link").forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();const a=e.target.textContent.trim();a.includes("所有訂單")||a.includes("未結案")||a.includes("已取消")||a.includes("黑名單")&&y("blacklists","blacklist")})});const E=document.querySelector(".js-blackListNum");function b(){v.get(`${k}/blackLists`).then(t=>{let e=t.data;E.textContent=e.length}).catch(t=>{console.log(t)})}b();const h=10;let m=1;function y(t,e){const a=document.querySelector(`#${e}`),n=a.querySelector(".pagination");v.get(`${k}/${t}`).then(o=>{let s=o.data;u(s,a),q(s,a,n)}).catch(o=>{console.log(o)})}function u(t,e){const a=(m-1)*h,n=a+h,s=t.sort((d,c)=>c.id-d.id).slice(a,n);if(e&&e.classList.contains("blacklist")){let d="";s.forEach(c=>{d+=`
                <tr>
                    <th scope="row" class="fw-normal">${c.name}</th>
                    <td>${c.email}</td>
                    <td>${c.phone}</td>
                    <td>${c.date}</td>
                    <td>${c.reason}</td>
                </tr>
                `}),document.querySelector(".js-blacklist").innerHTML=d}}function q(t,e,a){const n=Math.ceil(t.length/h),o=a;o.innerHTML="";const s=(r,f)=>{let L=`
            <li class="page-item">
                <a href="#" class="page-link" data-page="${r}">${r}</a>
            </li>
            `,D=document.createElement("div");return D.innerHTML=L,D.firstChild.addEventListener("click",f),D},d=s("<",()=>{m>1&&(m--,u(t,e))});o.appendChild(d);for(let r=1;r<=n;r++){const f=s(r,()=>{num=r,u(t,e)});o.appendChild(f)}const c=s(">",()=>{m<n&&(m++,u(t,e))});o.appendChild(c)}const i=document.querySelector(".blackForm"),x=document.querySelector(".js-blockName"),p=document.querySelector(".js-blockEmail"),g=document.querySelector(".js-blockPhone"),M=document.querySelector(".js-blockDate"),C=document.querySelector(".js-blockReason");i.addEventListener("submit",j);function j(t){if(t.preventDefault(),i.checkValidity())if(S(p.value.trim()))if(w(g.value.trim()))v.post(`${k}/blackLists`,{name:x.value.trim(),email:p.value.trim(),phone:g.value.trim(),date:M.value.trim(),reason:C.value.trim()}).then(e=>{T("新增成功!","",3e3),$("#blackListModal").modal("hide"),i.reset(),i.classList.remove("was-validated"),b(),y("blacklists","blacklist")}).catch(e=>{console.log(e)});else{i.querySelector(".js-errorPhone").innerHTML='<i class="bi bi-exclamation-circle me-4"></i> 手機號碼號碼格式錯誤',g.value="";return}else{i.querySelector(".js-errorEmail").innerHTML='<i class="bi bi-exclamation-circle me-4"></i> Email格式錯誤',p.value="";return}else{t.stopPropagation();return}}document.querySelectorAll(".btn-close").forEach(t=>{t.addEventListener("click",()=>{i.reset(),i.classList.remove("was-validated")})});document.querySelector(".js-clearFormBtn").addEventListener("click",()=>{i.reset(),i.classList.remove("was-validated")});

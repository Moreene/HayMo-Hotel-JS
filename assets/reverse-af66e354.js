import{e as s,i as v,j as f,s as k}from"./config-899afede.js";import"./userLogOut-da953201.js";import"./hamMenu-6b7faa69.js";import g from"https://cdnjs.cloudflare.com/ajax/libs/axios/1.5.1/esm/axios.js";$(function(){$.datepicker.regional["zh-TW"]={dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayNamesMin:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],prevText:"上月",nextText:"次月",weekHeader:"週"},$.datepicker.setDefaults($.datepicker.regional["zh-TW"]),$(function(){$(".datepicker").datepicker({beforeShow:function(t,a){a.dpDiv.addClass("custom-datepicker")},dateFormat:"yy-mm-dd",minDate:1,maxDate:"+3M",onSelect:function(t,a){e.date=t}}),$(".datepicker").on("change",function(t){const a=t.target.value;a&&(e.date=a)}),$(".startDate").datepicker({beforeShow:function(t,a){a.dpDiv.addClass("custom-datepicker")},dateFormat:"yy-mm-dd",minDate:1,maxDate:"+3M",onSelect:function(t,a){const r=new Date(t);if(e.endDate){const n=new Date(e.endDate);r>n?(s("入住日期不能大於退房日期！","請重新選擇日期"),$(".startDate").val("")):r.getDate()===n.getDate()&&r.getMonth()===n.getMonth()&&r.getFullYear()===n.getFullYear()?(s("入住日期不能與退房日期相同！","請重新選擇日期"),$(".startDate").val("")):e.startDate=t}else e.startDate=t;u(e)}}),$(".endDate").datepicker({beforeShow:function(t,a){a.dpDiv.addClass("custom-datepicker")},dateFormat:"yy-mm-dd",minDate:1,maxDate:"+3M",onSelect:function(t,a){const r=new Date(t);if(e.startDate){const n=new Date(e.startDate);n>r?(s("退房日期不能小於入住日期！","請重新選擇日期"),$(".endDate").val("")):n.getDate()===r.getDate()&&n.getMonth()===r.getMonth()&&n.getFullYear()===r.getFullYear()?(s("入住日期不能與退房日期相同！","請重新選擇日期"),$(".endDate").val("")):e.endDate=t}else e.endDate=t;u(e)}})})});$(".startDate").on("change",function(t){const a=t.target.value;if(a){const r=new Date(a);if(e.endDate){const n=new Date(e.endDate);r>n?(s("入住日期不能大於退房日期！","請重新選擇日期"),$(".startDate").val("")):r.getDate()===n.getDate()&&r.getMonth()===n.getMonth()&&r.getFullYear()===n.getFullYear()?(s("入住日期不能與退房日期相同！","請重新選擇日期"),$(".startDate").val("")):e.startDate=a}else e.startDate=a;u(e)}});$(".endDate").on("change",function(t){const a=t.target.value;if(a){const r=new Date(a);if(e.startDate){const n=new Date(e.startDate);n>r?(s("退房日期不能小於入住日期！","請重新選擇日期"),$(".endDate").val("")):n.getDate()===r.getDate()&&n.getMonth()===r.getMonth()&&n.getFullYear()===r.getFullYear()?(s("入住日期不能與退房日期相同！","請重新選擇日期"),$(".endDate").val("")):e.endDate=a}else e.endDate=a;u(e)}});$(document).ready(function(){$(".timepicker").timepicker({timeFormat:"h:i A",step:60,minTime:"9:00",maxTime:"21:00",startTime:"9:00",dynamic:!0}),$(".timepicker").on("changeTime",function(){e.time=$(this).val()})});(function(){var t=document.querySelectorAll(".needs-validation");Array.prototype.slice.call(t).forEach(function(a){a.addEventListener("submit",function(r){a.checkValidity()||(r.preventDefault(),r.stopPropagation()),a.classList.add("was-validated")},!1)})})();const l=location.href.split("=")[1];let e={service:"安親",total:900,isParadiseYes:!1,remark:""};const S=document.querySelector(".js-service"),d=document.querySelectorAll(".js-reverseForm"),p=document.querySelectorAll(".js-nameSelect"),y=document.querySelectorAll(".js-paradise"),Z=document.querySelectorAll("#emergencyContact"),E=document.querySelectorAll("#emergencyPhone"),C=document.querySelectorAll(".js-contact"),L=document.querySelectorAll(".js-phone"),N=document.querySelectorAll("#remark"),F=document.querySelector(".js-size"),Y=document.querySelector(".js-plan");let o=0,i=0;const M=document.querySelector(".js-room");S.addEventListener("click",function(t){e.isParadiseYes=!1,t.target.textContent==="狗狗安親"?(d.forEach(a=>a.reset()),e={service:"安親",total:900,isYesClicked:!1,remark:""},o=0,i=0):t.target.textContent==="狗狗美容"?(d.forEach(a=>a.reset()),e={service:"美容",total:0,isYesClicked:!1,remark:""},o=0,i=0):t.target.textContent==="狗狗住宿"&&(d.forEach(a=>a.reset()),e={service:"住宿",total:0,isYesClicked:!1,remark:""},o=0,i=0)});y.forEach(t=>{t.addEventListener("click",function(a){a.target.classList.contains("form-check-input")&&(e.paradise=a.target.value,a.target.value==="是"&&!e.isParadiseYes?(e.total+=200,e.isParadiseYes=!0):a.target.value==="否"&&e.isYesClicked&&(e.total-=200,e.isParadiseYes=!1))})});function q(){g.get(`${f}/660/dogs?userId=${l}`,{headers:{authorization:`Bearer ${localStorage.getItem("userToken")}`}}).then(t=>{if(t){let a=t.data;w(a)}}).catch(t=>{console.log(t)})}q();function w(t){let a="";t.forEach(r=>{a+=`<option value="${r.name}">${r.name}</option>`}),p.forEach(r=>{r.insertAdjacentHTML("beforeend",a)})}p.forEach(function(t){t.addEventListener("change",function(a){e.dogName=a.target.value})});function j(){g.get(`${f}/660/users/${l}`,{headers:{authorization:`Bearer ${localStorage.getItem("userToken")}`}}).then(t=>{if(t){let a=t.data;A(a),P(a)}}).catch(t=>{console.log(t)})}j();function A(t){let a="";a=`<option value="${t.name}"></option>`,Z.forEach(r=>{r.insertAdjacentHTML("beforeend",a)})}function P(t){let a="";a=`<option value="${t.phone}"></option>`,E.forEach(r=>{r.insertAdjacentHTML("beforeend",a)})}C.forEach(t=>{t.addEventListener("input",function(a){a.target.value!==""&&(e.contact=a.target.value.trim())})});L.forEach(t=>{t.addEventListener("change",function(a){e.phone=a.target.value.trim()})});N.forEach(t=>{t.addEventListener("input",function(a){e.remark=a.target.value.trim()})});F.addEventListener("click",function(t){t.target.value!==void 0&&(t.target.value==="小於10kg"?(e.dogSize="小於10kg",o=200):t.target.value==="10-20kg"?(e.dogSize="10-20kg",o=300):t.target.value==="大於20kg"&&(e.dogSize="大於20kg",o=450),e.total=o+i+(e.paradise==="是"?200:0))});Y.addEventListener("click",function(t){t.target.value!==void 0&&(t.target.value==="基礎洗香香"?(e.plan="基礎洗香香",i=550):t.target.value==="進階洗香香"?(e.plan="進階洗香香",i=800):t.target.value==="高級洗香香"&&(e.plan="高級洗香香",i=1e3),e.total=o+i+(e.paradise==="是"?200:0))});M.addEventListener("click",function(t){t.target.value!==void 0&&(t.target.value==="小狗香香房"?e.room="小狗香香房":t.target.value==="忠犬呼嚕房"?e.room="忠犬呼嚕房":t.target.value==="大狗好眠房"&&(e.room="大狗好眠房"),u(e))});function u(t){if(!t.room||!t.startDate||!t.endDate)return;const a=new Date(t.startDate),r=new Date(t.endDate),n=Math.ceil((r-a)/(1e3*60*60*24));t.room==="小狗香香房"?t.total=1e3*n:t.room==="忠犬呼嚕房"?t.total=1350*n:t.room==="大狗好眠房"&&(t.total=1600*n)}let h=!1;h||(d.forEach(t=>{t.addEventListener("submit",z)}),h=!0);function z(t){t.preventDefault(),d.forEach(a=>{if(a.checkValidity())if(!v(e.phone))a.querySelector(".js-phoneError").innerHTML='<i class="bi bi-exclamation-circle me-4"></i>手機號碼格式錯誤',a.querySelector(".js-phone").value="";else{let r={};if(e.service==="安親"){const n=m();r={userId:l,orderNum:n,dogName:e.dogName,service:e.service,date:e.date,time:e.time,paradise:e.paradise,contact:e.contact,phone:e.phone,remark:e.remark,total:e.total,isChecked:!1}}else if(e.service==="美容"){const n=m();r={userId:l,orderNum:n,dogName:e.dogName,service:e.service,size:e.dogSize,plan:e.plan,date:e.date,time:e.time,paradise:e.paradise,contact:e.contact,phone:e.phone,remark:e.remark,total:e.total,isChecked:!1}}else if(e.service==="住宿"){const n=m();r={userId:l,orderNum:n,dogName:e.dogName,service:e.service,room:e.room,date:e.startDate,startDate:e.startDate,endDate:e.endDate,time:e.time,paradise:"已包含",contact:e.contact,phone:e.phone,remark:e.remark,total:e.total,isChecked:!1}}g.post(`${f}/660/reverse`,r,{headers:{authorization:`Bearer ${localStorage.getItem("userToken")}`}}).then(n=>{k("預約成功！","",3e3),a.reset(),a.classList.remove("was-validated"),o=0,i=0,e.service==="安親"?e={service:"安親",total:900,isYesClicked:!1,remark:""}:e.service==="美容"?e={service:"美容",total:0,isYesClicked:!1,remark:""}:e.service==="住宿"&&(e={service:"住宿",total:0,isYesClicked:!1,remark:""})}).catch(n=>{console.log(n)})}else{t.stopPropagation();return}})}const D=["Z035212","Z021059","Z008541","Z011423","Z045519","Z035010","Z015945","Z051203","Z032981","Z000152","Z015498","Z072090","Z031268","Z000110","Z082016","Z000019","Z011334","Z061546","Z090001","Z005213","Z077277","Z010024","Z053128","Z044160","Z091203","Z033927","Z066369","Z011125","Z058103","Z000761","Z015638","Z029983","Z022419","Z088642","Z000066","Z041297","Z041297","Z061950","Z016563"];function m(){let t;do t=`Z0${String(Math.floor(Math.random()*1e5)).padStart(5,"0")}`;while(D.includes(t));return D.push(t),t}function c(t){document.querySelector(`.${t}`).reset(),document.querySelector(`.${t}`).classList.remove("was-validated")}document.querySelectorAll(".option-link").forEach(t=>{t.addEventListener("click",a=>{a.target.textContent==="狗狗安親"?(c("cosmeticForm"),c("stayForm")):a.target.textContent==="狗狗美容"?(c("dayCareForm"),c("stayForm")):a.target.textContent==="狗狗住宿"&&(c("dayCareForm"),c("cosmeticForm"))})});
